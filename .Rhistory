axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
mississippi_fcb <- sfc2 %>%
mutate(START_DATE = str_extract(sfc2$START_DATE_TIME, "[:digit:]{2}/[:digit:]{2}/[:digit:]{4}")) %>%
mutate(START_DATE = as.Date(START_DATE, "%m/%d/%y")) %>%
filter(PARAMETER == "Fecal Coliform Bacteria Count") %>%
group_by(STATION_ID) %>%
arrange(desc(START_DATE), .by_group = TRUE) %>%
slice_head() %>%
mutate(NA2Cat = cut(NA2, breaks =c(0,400, 2000, 20000, 90001), labels = c("0-400", "401-2,000", "2,001-20,000", "20,001-90,000")))
ggplot() +
geom_sf(data = counties, color = "navajowhite", fill = "ivory", size = 0.5) +
geom_sf(data = states_new, color = "tan3", fill = "NA") +
geom_sf(data = mn_cities1, color = "black", size = 3, shape= 15) +
geom_sf(data = rivers %>% filter(NAME_DNR == "Mississippi"),color = "NA", fill = 'cornflowerblue') +
geom_sf_label_repel(data = mn_cities1, aes(label = Name), nudge_y=0.05) +
geom_sf(data = mississippi_fcb, mapping = aes(color = NA2Cat), size = 2.5)+
scale_color_manual(legend_title, values = c("mediumseagreen", "gold", "orange1","red2"))+
coord_sf(xlim = c(-93.41, -92.1), ylim= c(44.4, 45.2)) +
annotate(geom="text", x=-93.21, y=44.65, label="Minnesota",
size = 5, color = "tan3")+
annotate(geom="text", x=-92.3, y=44.7, label="Wisconsin",
size = 5, color = "tan3")+
labs(x = "", y = "", title = "Fecal Coliform Bacteria (FCB) Levels in the Mississippi River", subtitle = "Data from 2019 and 2020 at 34 monitoring stations in Southeastern Minnesota") +
annotation_scale(location = "bl")+
theme_classic() +
theme(legend.position = c(.95, .95),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.box.background = element_rect(color="black", size=1),
legend.text = element_text(size = 7),legend.title = element_text(size = 8, face = "bold"),
plot.title = element_text(face = "bold"), axis.line=element_blank(),axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
ggplot() +
geom_sf(data = counties, color = "navajowhite", fill = "ivory", size = 0.5) +
geom_sf(data = states_new, color = "tan3", fill = "NA") +
geom_sf(data = mn_cities1, color = "black", size = 3, shape= 15) +
geom_sf(data = rivers %>% filter(NAME_DNR == "Mississippi"),color = "NA", fill = 'cornflowerblue') +
geom_sf_label_repel(data = mn_cities1, aes(label = Name), nudge_y=0.05) +
geom_sf(data = mississippi_fcb, mapping = aes(color = NA2Cat), size = 2.5)+
scale_color_manual(legend_title, values = c("mediumseagreen", "gold", "orange1","red2"))+
coord_sf(xlim = c(-93.41, -92.1), ylim= c(44.4, 45.2)) +
annotate(geom="text", x=-93.21, y=44.65, label="Minnesota",
size = 5, color = "tan3")+
annotate(geom="text", x=-92.3, y=44.7, label="Wisconsin",
size = 5, color = "tan3")+
labs(x = "", y = "", title = "Fecal Coliform Bacteria (FCB) Levels in the Mississippi River", subtitle = "Data from 2019 and 2020 at 34 monitoring stations in Southeastern Minnesota", caption = "Plot by Vivian Powell | Data from Metropolitan Council EIMS") +
annotation_scale(location = "bl")+
theme_classic() +
theme(legend.position = c(.95, .95),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.box.background = element_rect(color="black", size=1),
legend.text = element_text(size = 7),legend.title = element_text(size = 8, face = "bold"),
plot.title = element_text(face = "bold"), axis.line=element_blank(),axis.text.x=element_blank(),plot.title = element_text(hjust = 0.5),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
ggplot() +
geom_sf(data = counties, color = "navajowhite", fill = "ivory", size = 0.5) +
geom_sf(data = states_new, color = "tan3", fill = "NA") +
geom_sf(data = mn_cities1, color = "black", size = 3, shape= 15) +
geom_sf(data = rivers %>% filter(NAME_DNR == "Mississippi"),color = "NA", fill = 'cornflowerblue') +
geom_sf_label_repel(data = mn_cities1, aes(label = Name), nudge_y=0.05) +
geom_sf(data = mississippi_fcb, mapping = aes(color = NA2Cat), size = 2.5)+
scale_color_manual(legend_title, values = c("mediumseagreen", "gold", "orange1","red2"))+
coord_sf(xlim = c(-93.41, -92.1), ylim= c(44.4, 45.2)) +
annotate(geom="text", x=-93.21, y=44.65, label="Minnesota",
size = 5, color = "tan3")+
annotate(geom="text", x=-92.3, y=44.7, label="Wisconsin",
size = 5, color = "tan3")+
labs(x = "", y = "", title = "Fecal Coliform Bacteria (FCB) Levels in the Mississippi River", subtitle = "Data from 2019 and 2020 at 34 monitoring stations in Southeastern Minnesota", caption = "Plot by Vivian Powell | Data from Metropolitan Council EIMS") +
annotation_scale(location = "bl")+
theme_classic() +
theme(legend.position = c(.95, .95),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.box.background = element_rect(color="black", size=1),
legend.text = element_text(size = 7),legend.title = element_text(size = 8, face = "bold"),
plot.title = element_text(face = "bold", hjust = 0.5), axis.line=element_blank(),axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
ggplot() +
geom_sf(data = counties, color = "navajowhite", fill = "ivory", size = 0.5) +
geom_sf(data = states_new, color = "tan3", fill = "NA") +
geom_sf(data = mn_cities1, color = "black", size = 3, shape= 15) +
geom_sf(data = rivers %>% filter(NAME_DNR == "Mississippi"),color = "NA", fill = 'cornflowerblue') +
geom_sf_label_repel(data = mn_cities1, aes(label = Name), nudge_y=0.05) +
geom_sf(data = mississippi_fcb, mapping = aes(color = NA2Cat), size = 2.5)+
scale_color_manual(legend_title, values = c("mediumseagreen", "gold", "orange1","red2"))+
coord_sf(xlim = c(-93.41, -92.1), ylim= c(44.4, 45.2)) +
annotate(geom="text", x=-93.21, y=44.65, label="Minnesota",
size = 5, color = "tan3")+
annotate(geom="text", x=-92.3, y=44.7, label="Wisconsin",
size = 5, color = "tan3")+
labs(x = "", y = "", title = "Fecal Coliform Bacteria (FCB) Levels in the Mississippi River", subtitle = "Data from 2019 and 2020 at 34 monitoring stations in Southeastern Minnesota", caption = "Plot by Vivian Powell | Data from Metropolitan Council EIMS") +
annotation_scale(location = "bl")+
theme_classic() +
theme(legend.position = c(.95, .95),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.box.background = element_rect(color="black", size=1),
legend.text = element_text(size = 7),legend.title = element_text(size = 8, face = "bold"),
plot.title = element_text(face = "bold", hjust = 0.5), plot.subtitle = element_text(hjust = 0.5),plot.caption = element_text(hjust = 0.5),axis.line=element_blank(),axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
ggsave(fp2_vivian)
ggsave(filename =fp2_vivian)
ggsave(filename = "fp2_vivian")
ggsave(filename = "fp2_vivian", "png")
ggsave(filename = "fp2_vivian.png")
mississippi_fcb <- sfc2 %>%
mutate(START_DATE = str_extract(sfc2$START_DATE_TIME, "[:digit:]{2}/[:digit:]{2}/[:digit:]{4}")) %>%
mutate(START_DATE = as.Date(START_DATE, "%m/%d/%y")) %>%
filter(PARAMETER == "Fecal Coliform Bacteria Count") %>%
group_by(STATION_ID) %>%
arrange(desc(START_DATE), .by_group = TRUE) %>%
slice_head() %>%
mutate(NA2Cat = cut(NA2, breaks =c(0,300, 2000, 20000, 90001), labels = c("0-300", "301-2,000", "2,001-20,000", "20,001-90,000")))
ggplot() +
geom_sf(data = counties, color = "navajowhite", fill = "ivory", size = 0.5) +
geom_sf(data = states_new, color = "tan3", fill = "NA") +
geom_sf(data = mn_cities1, color = "black", size = 3, shape= 15) +
geom_sf(data = rivers %>% filter(NAME_DNR == "Mississippi"),color = "NA", fill = 'cornflowerblue') +
geom_sf_label_repel(data = mn_cities1, aes(label = Name), nudge_y=0.05) +
geom_sf(data = mississippi_fcb, mapping = aes(color = NA2Cat), size = 2.5)+
scale_color_manual(legend_title, values = c("mediumseagreen", "gold", "orange1","red2"))+
coord_sf(xlim = c(-93.41, -92.1), ylim= c(44.4, 45.2)) +
annotate(geom="text", x=-93.21, y=44.65, label="Minnesota",
size = 5, color = "tan3")+
annotate(geom="text", x=-92.3, y=44.7, label="Wisconsin",
size = 5, color = "tan3")+
labs(x = "", y = "", title = "Fecal Coliform Bacteria (FCB) Levels in the Mississippi River", subtitle = "Data from 2019 and 2020 at 34 monitoring stations in Southeastern Minnesota", caption = "Plot by Vivian Powell | Data from Metropolitan Council EIMS") +
annotation_scale(location = "bl")+
theme_classic() +
theme(legend.position = c(.95, .95),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.box.background = element_rect(color="black", size=1),
legend.text = element_text(size = 7),legend.title = element_text(size = 8, face = "bold"),
plot.title = element_text(face = "bold", hjust = 0.5), plot.subtitle = element_text(hjust = 0.5),plot.caption = element_text(hjust = 0.5),axis.line=element_blank(),axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
ggsave(filename = "fp2_vivian.png")
river2 <- read_sf('Miss_RiverBasin)
river2 <- read_sf('Miss_RiverBasin')
river2 <- read_sf('Miss_RiverBasin')
View(river2)
ggplot() +
geom_sf(data = counties, color = "navajowhite", fill = "ivory", size = 0.5) +
geom_sf(data = states_new, color = "tan3", fill = "NA") +
geom_sf(data = mn_cities1, color = "black", size = 3, shape= 15) +
geom_sf(data = rivers %>% filter(NAME_DNR == "Mississippi"),color = "NA", fill = 'cornflowerblue') +
geom_sf(data = river2, color = "NA", fill = "cornflowerblue")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(sf)
library(lubridate)
library(gganimate)
library(ggtext)
library(showtext)
library(ggalt)
font_add_google("Architects Daughter")
showtext_auto()
county_boundaries <- st_read("data/shp_bdry_counties_in_minnesota/mn_county_boundaries_500.shp")
stationList <- read_csv("https://services.pca.state.mn.us/api/v1/groundwater/monitoring-stations?stationType=Well&format=csv") %>%
filter(stationPurpose %in% c("Domestic Drinking", "Public Drinking"), sampleCount>0)
station_points <- stationList %>%
filter(lat > 0, long <0) %>%
st_as_sf(coords = c("long", "lat"), crs = "NAD83")
county_boundaries <- st_transform(county_boundaries, crs = "NAD83")
ggplot() +
geom_sf(data = county_boundaries, fill = "white") +
geom_sf(data = station_points, color = "cadetblue", alpha = 0.3) +
theme_minimal()+
theme(axis.text = element_blank(),
panel.grid = element_blank())
stations7county <-
st_join(station_points, county_boundaries) %>%
select(endYear, resultCount, sampleCount, siteList, startYear, stationId, stationName, stationPurpose, stationType, AREA, CTY_NAME) %>%
mutate(end = as.Date(endYear),
start = as.Date(startYear),
startYear = as.integer(str_sub(start, 1, 4))) %>%
filter(CTY_NAME %in% c("Anoka", "Hennepin", "Ramsey", "Dakota", "Carver", "Washington", "Scott"))
stations_per_county <- st_join(station_points, county_boundaries) %>%
select(endYear, resultCount, sampleCount, siteList, startYear, stationId, stationName, stationPurpose, stationType, AREA, CTY_NAME) %>%
group_by(CTY_NAME) %>%
count() %>%
st_drop_geometry()
stations_per_county$lots <- "1,000+"
stations_per_county$lots[stations_per_county$n <= 1000] <- NA
joined <- county_boundaries %>%
left_join(stations_per_county, by = "CTY_NAME")
chloropleth_map <- ggplot() +
geom_sf(data= subset(joined, n<1000), aes(fill=n)) +
scale_fill_gradientn(colours = c("lightcyan", "lightcyan2", "lightskyblue3", "lightskyblue4"))+
geom_sf(data = subset(joined, n>1000),aes(color=lots), fill = "dodgerblue4")+
labs(fill = "Wells", color = "", title = "Number of domestic/public drinking wells by Minnesota county", subtitle= "with at least one MPCA sample since 1988")+
theme_classic()+
theme(axis.line = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
legend.position = "bottom",
plot.title.position = "plot",
plot.title = element_markdown(family = "Architects Daughter", size =10),
plot.subtitle = element_markdown(family = "Architects Daughter", size =10),
legend.title = element_markdown(family = "Architects Daughter", size =10))
chloropleth_map
boundaries_7county <- county_boundaries %>% filter(CTY_NAME %in% c("Anoka", "Hennepin", "Ramsey", "Dakota", "Carver", "Washington", "Scott"))
map <- ggplot()+
geom_sf(data = boundaries_7county,fill = "white") +
geom_sf(data = stations7county, aes(group = startYear), color = "forestgreen", alpha = 0.5) +
theme_minimal()+
labs(title = "First MPCA sample year for drinking wells in the 7-county metro area", x="", y="", color = "Num Samples", subtitle = "{frame_time}")+
theme(axis.text = element_blank(),
panel.grid = element_blank(),
plot.title.position = "plot",
plot.subtitle = element_markdown(size =25))+
annotate(geom = "point", y=44.9343, x=-93.1671, color = "black", size =1.3)+
annotate(geom = "text", y=44.965, x=-93.14, label = "Macalester \nCollege", size = 2)+
transition_time(startYear)+
shadow_mark()
animate(map, duration = 12, end_pause = 4)
wi_rivers <- read_sf('wisconsin_rivers)
library(readr)
library(dplyr)
library(tidyverse)
library(sf)
library(rlang)
library(janitor)
library(ggsflabel)
library(ggspatial)
library(USAboundaries)
library(readr)
library(dplyr)
library(tidyverse)
library(sf)
library(rlang)
library(janitor)
library(ggsflabel)
library(ggspatial)
library(USAboundaries)
counties <- us_counties(resolution = "high", states = c("Minnesota", "Wisconsin")) %>%
st_transform(crs = 6783)
mn_wi_states <- us_states(resolution = "high", states = c("Minnesota", "Wisconsin")) %>%
st_transform(crs = 6783)
miss_river_main_contaminants <- read_csv("miss_river_main_contaminants.csv")
m_river <- miss_river_main_contaminants[-c(1:4),]
colnames(m_river) <- m_river[1,]
m_river <- m_river[-c(1),]
nms2 <- names(m_river)
names(m_river)[nms2 == 'NA'] <- c("NA1", "NA2", "UTM_long", "UTM_lat")
df_sf2 <- st_as_sf(x = m_river,
coords = c("UTM_long", "UTM_lat"),
crs = "+proj=utm +zone=15")
sfc2 = st_transform(df_sf2, crs = "+proj=longlat +datum=NAD83")
mississippi_fcb <- sfc2 %>%
mutate(START_DATE = str_extract(sfc2$START_DATE_TIME, "[:digit:]{2}/[:digit:]{2}/[:digit:]{4}")) %>%
mutate(START_DATE = as.Date(START_DATE, "%m/%d/%y")) %>%
filter(PARAMETER == "Fecal Coliform Bacteria Count") %>%
group_by(STATION_ID) %>%
arrange(desc(START_DATE), .by_group = TRUE) %>%
slice_head() %>%
mutate(NA2Cat = cut(NA2, breaks =c(0,300, 2000, 20000, 90001), labels = c("0-300", "301-2,000", "2,001-20,000", "20,001-90,000")))
rivers <- read_sf('shp_water_lakes_rivers')
wi_rivers <- read_sf('wisconsin_rivers)
mn_cities1 <- read_sf('shp_loc_pop_centers') %>%
miss_river_main_contaminants <- read_csv("miss_river_main_contaminants.csv")
m_river <- miss_river_main_contaminants[-c(1:4),]
colnames(m_river) <- m_river[1,]
m_river <- m_river[-c(1),]
nms2 <- names(m_river)
names(m_river)[nms2 == 'NA'] <- c("NA1", "NA2", "UTM_long", "UTM_lat")
df_sf2 <- st_as_sf(x = m_river,
coords = c("UTM_long", "UTM_lat"),
crs = "+proj=utm +zone=15")
sfc2 = st_transform(df_sf2, crs = "+proj=longlat +datum=NAD83")
mississippi_fcb <- sfc2 %>%
mutate(START_DATE = str_extract(sfc2$START_DATE_TIME, "[:digit:]{2}/[:digit:]{2}/[:digit:]{4}")) %>%
mutate(START_DATE = as.Date(START_DATE, "%m/%d/%y")) %>%
filter(PARAMETER == "Fecal Coliform Bacteria Count") %>%
group_by(STATION_ID) %>%
arrange(desc(START_DATE), .by_group = TRUE) %>%
slice_head() %>%
mutate(NA2Cat = cut(NA2, breaks =c(0,300, 2000, 20000, 90001), labels = c("0-300", "301-2,000", "2,001-20,000", "20,001-90,000")))
rivers <- read_sf('shp_water_lakes_rivers')
wi_rivers <- read_sf('wisconsin_rivers')
mn_cities1 <- read_sf('shp_loc_pop_centers') %>%
filter(Name %in% c("Minneapolis", "St. Paul"))
states_new <- st_crop(mn_wi_states, st_bbox(counties))
legend_title <- "FCB per 100 mL"
View(wi_rivers)
View(wi_rivers)
View(wi_rivers)
ggplot() +
geom_sf(data = counties, color = "navajowhite", fill = "ivory", size = 0.5) +
geom_sf(data = states_new, color = "tan3", fill = "NA") +
geom_sf(data = mn_cities1, color = "black", size = 3, shape= 15) +
geom_sf(data = rivers %>% filter(NAME_DNR == "Mississippi"),color = "NA", fill = 'cornflowerblue') +
geom_sf(data = wi_rivers %>% filter(WATERBODY_ = "Mississippi River")) +
geom_sf_label_repel(data = mn_cities1, aes(label = Name), nudge_y=0.05) +
geom_sf(data = mississippi_fcb, mapping = aes(color = NA2Cat), size = 2.5)+
scale_color_manual(legend_title, values = c("mediumseagreen", "gold", "orange1","red2"))+
coord_sf(xlim = c(-93.41, -92.1), ylim= c(44.4, 45.2)) +
annotate(geom="text", x=-93.21, y=44.65, label="Minnesota",
size = 5, color = "tan3")+
annotate(geom="text", x=-92.3, y=44.7, label="Wisconsin",
size = 5, color = "tan3")+
labs(x = "", y = "", title = "Fecal Coliform Bacteria (FCB) Levels in the Mississippi River", subtitle = "Data from 2019 and 2020 at 34 monitoring stations in Southeastern Minnesota", caption = "Plot by Vivian Powell | Data from Metropolitan Council EIMS") +
annotation_scale(location = "bl")+
theme_classic() +
theme(legend.position = c(.95, .95),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.box.background = element_rect(color="black", size=1),
legend.text = element_text(size = 7),legend.title = element_text(size = 8, face = "bold"),
plot.title = element_text(face = "bold", hjust = 0.5), plot.subtitle = element_text(hjust = 0.5),plot.caption = element_text(hjust = 0.5),axis.line=element_blank(),axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
ggplot() +
geom_sf(data = counties, color = "navajowhite", fill = "ivory", size = 0.5) +
geom_sf(data = states_new, color = "tan3", fill = "NA") +
geom_sf(data = mn_cities1, color = "black", size = 3, shape= 15) +
geom_sf(data = rivers %>% filter(NAME_DNR == "Mississippi"),color = "NA", fill = 'cornflowerblue') +
geom_sf(data = wi_rivers %>% filter(WATERBODY_ == "Mississippi River")) +
geom_sf_label_repel(data = mn_cities1, aes(label = Name), nudge_y=0.05) +
geom_sf(data = mississippi_fcb, mapping = aes(color = NA2Cat), size = 2.5)+
scale_color_manual(legend_title, values = c("mediumseagreen", "gold", "orange1","red2"))+
coord_sf(xlim = c(-93.41, -92.1), ylim= c(44.4, 45.2)) +
annotate(geom="text", x=-93.21, y=44.65, label="Minnesota",
size = 5, color = "tan3")+
annotate(geom="text", x=-92.3, y=44.7, label="Wisconsin",
size = 5, color = "tan3")+
labs(x = "", y = "", title = "Fecal Coliform Bacteria (FCB) Levels in the Mississippi River", subtitle = "Data from 2019 and 2020 at 34 monitoring stations in Southeastern Minnesota", caption = "Plot by Vivian Powell | Data from Metropolitan Council EIMS") +
annotation_scale(location = "bl")+
theme_classic() +
theme(legend.position = c(.95, .95),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.box.background = element_rect(color="black", size=1),
legend.text = element_text(size = 7),legend.title = element_text(size = 8, face = "bold"),
plot.title = element_text(face = "bold", hjust = 0.5), plot.subtitle = element_text(hjust = 0.5),plot.caption = element_text(hjust = 0.5),axis.line=element_blank(),axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
ggsave(filename = "fp2_vivian.png")
ggplot() +
geom_sf(data = counties, color = "navajowhite", fill = "ivory", size = 0.5) +
geom_sf(data = states_new, color = "tan3", fill = "NA") +
geom_sf(data = mn_cities1, color = "black", size = 3, shape= 15) +
geom_sf(data = rivers %>% filter(NAME_DNR == "Mississippi"),color = "NA", fill = 'cornflowerblue') +
geom_sf(data = wi_rivers %>% filter(WATERBODY_ == "Mississippi River"), color = "NA", fill = "cornflowerblue") +
geom_sf_label_repel(data = mn_cities1, aes(label = Name), nudge_y=0.05) +
geom_sf(data = mississippi_fcb, mapping = aes(color = NA2Cat), size = 2.5)+
scale_color_manual(legend_title, values = c("mediumseagreen", "gold", "orange1","red2"))+
coord_sf(xlim = c(-93.41, -92.1), ylim= c(44.4, 45.2)) +
annotate(geom="text", x=-93.21, y=44.65, label="Minnesota",
size = 5, color = "tan3")+
annotate(geom="text", x=-92.3, y=44.7, label="Wisconsin",
size = 5, color = "tan3")+
labs(x = "", y = "", title = "Fecal Coliform Bacteria (FCB) Levels in the Mississippi River", subtitle = "Data from 2019 and 2020 at 34 monitoring stations in Southeastern Minnesota", caption = "Plot by Vivian Powell | Data from Metropolitan Council EIMS") +
annotation_scale(location = "bl")+
theme_classic() +
theme(legend.position = c(.95, .95),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.box.background = element_rect(color="black", size=1),
legend.text = element_text(size = 7),legend.title = element_text(size = 8, face = "bold"),
plot.title = element_text(face = "bold", hjust = 0.5), plot.subtitle = element_text(hjust = 0.5),plot.caption = element_text(hjust = 0.5),axis.line=element_blank(),axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
ggsave(filename = "fp2_vivian.png")
View(wi_rivers)
ggplot() +
geom_sf(data = counties, color = "navajowhite", fill = "ivory", size = 0.5) +
geom_sf(data = states_new, color = "tan3", fill = "NA") +
geom_sf(data = mn_cities1, color = "black", size = 3, shape= 15) +
geom_sf(data = rivers %>% filter(NAME_DNR == "Mississippi"),color = "NA", fill = 'cornflowerblue') +
geom_sf(data = wi_rivers %>% filter(RIVER_SYS_ == "Mississippi River"), color = "NA", fill = "cornflowerblue") +
geom_sf_label_repel(data = mn_cities1, aes(label = Name), nudge_y=0.05) +
geom_sf(data = mississippi_fcb, mapping = aes(color = NA2Cat), size = 2.5)+
scale_color_manual(legend_title, values = c("mediumseagreen", "gold", "orange1","red2"))+
coord_sf(xlim = c(-93.41, -92.1), ylim= c(44.4, 45.2)) +
annotate(geom="text", x=-93.21, y=44.65, label="Minnesota",
size = 5, color = "tan3")+
annotate(geom="text", x=-92.3, y=44.7, label="Wisconsin",
size = 5, color = "tan3")+
labs(x = "", y = "", title = "Fecal Coliform Bacteria (FCB) Levels in the Mississippi River", subtitle = "Data from 2019 and 2020 at 34 monitoring stations in Southeastern Minnesota", caption = "Plot by Vivian Powell | Data from Metropolitan Council EIMS") +
annotation_scale(location = "bl")+
theme_classic() +
theme(legend.position = c(.95, .95),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.box.background = element_rect(color="black", size=1),
legend.text = element_text(size = 7),legend.title = element_text(size = 8, face = "bold"),
plot.title = element_text(face = "bold", hjust = 0.5), plot.subtitle = element_text(hjust = 0.5),plot.caption = element_text(hjust = 0.5),axis.line=element_blank(),axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
View(wi_rivers)
ggplot() +
geom_sf(data = counties, color = "navajowhite", fill = "ivory", size = 0.5) +
geom_sf(data = states_new, color = "tan3", fill = "NA") +
geom_sf(data = mn_cities1, color = "black", size = 3, shape= 15) +
geom_sf(data = rivers %>% filter(NAME_DNR == "Mississippi"),color = "NA", fill = 'cornflowerblue') +
geom_sf(data = wi_rivers %>% filter(RIVER_SYS_ == "Mississippi River", HYDROTYPE == "710"), color = "NA", fill = "cornflowerblue") +
geom_sf_label_repel(data = mn_cities1, aes(label = Name), nudge_y=0.05) +
geom_sf(data = mississippi_fcb, mapping = aes(color = NA2Cat), size = 2.5)+
scale_color_manual(legend_title, values = c("mediumseagreen", "gold", "orange1","red2"))+
coord_sf(xlim = c(-93.41, -92.1), ylim= c(44.4, 45.2)) +
annotate(geom="text", x=-93.21, y=44.65, label="Minnesota",
size = 5, color = "tan3")+
annotate(geom="text", x=-92.3, y=44.7, label="Wisconsin",
size = 5, color = "tan3")+
labs(x = "", y = "", title = "Fecal Coliform Bacteria (FCB) Levels in the Mississippi River", subtitle = "Data from 2019 and 2020 at 34 monitoring stations in Southeastern Minnesota", caption = "Plot by Vivian Powell | Data from Metropolitan Council EIMS") +
annotation_scale(location = "bl")+
theme_classic() +
theme(legend.position = c(.95, .95),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.box.background = element_rect(color="black", size=1),
legend.text = element_text(size = 7),legend.title = element_text(size = 8, face = "bold"),
plot.title = element_text(face = "bold", hjust = 0.5), plot.subtitle = element_text(hjust = 0.5),plot.caption = element_text(hjust = 0.5),axis.line=element_blank(),axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
ggplot() +
geom_sf(data = counties, color = "navajowhite", fill = "ivory", size = 0.5) +
geom_sf(data = states_new, color = "tan3", fill = "NA") +
geom_sf(data = mn_cities1, color = "black", size = 3, shape= 15) +
geom_sf(data = rivers %>% filter(NAME_DNR == "Mississippi"),color = "NA", fill = 'cornflowerblue') +
geom_sf(data = wi_rivers %>% filter(RIVER_SYS_ == "Mississippi River", HYDROTYPE == "706"), color = "NA", fill = "cornflowerblue") +
geom_sf_label_repel(data = mn_cities1, aes(label = Name), nudge_y=0.05) +
geom_sf(data = mississippi_fcb, mapping = aes(color = NA2Cat), size = 2.5)+
scale_color_manual(legend_title, values = c("mediumseagreen", "gold", "orange1","red2"))+
coord_sf(xlim = c(-93.41, -92.1), ylim= c(44.4, 45.2)) +
annotate(geom="text", x=-93.21, y=44.65, label="Minnesota",
size = 5, color = "tan3")+
annotate(geom="text", x=-92.3, y=44.7, label="Wisconsin",
size = 5, color = "tan3")+
labs(x = "", y = "", title = "Fecal Coliform Bacteria (FCB) Levels in the Mississippi River", subtitle = "Data from 2019 and 2020 at 34 monitoring stations in Southeastern Minnesota", caption = "Plot by Vivian Powell | Data from Metropolitan Council EIMS") +
annotation_scale(location = "bl")+
theme_classic() +
theme(legend.position = c(.95, .95),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.box.background = element_rect(color="black", size=1),
legend.text = element_text(size = 7),legend.title = element_text(size = 8, face = "bold"),
plot.title = element_text(face = "bold", hjust = 0.5), plot.subtitle = element_text(hjust = 0.5),plot.caption = element_text(hjust = 0.5),axis.line=element_blank(),axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
ggplot() +
geom_sf(data = counties, color = "navajowhite", fill = "ivory", size = 0.5) +
geom_sf(data = states_new, color = "tan3", fill = "NA") +
geom_sf(data = mn_cities1, color = "black", size = 3, shape= 15) +
geom_sf(data = rivers %>% filter(NAME_DNR == "Mississippi"),color = "NA", fill = 'cornflowerblue') +
geom_sf(data = wi_rivers %>% filter(WATERBODY_1 == "Mississippi River"), color = "NA", fill = "cornflowerblue") +
geom_sf_label_repel(data = mn_cities1, aes(label = Name), nudge_y=0.05) +
geom_sf(data = mississippi_fcb, mapping = aes(color = NA2Cat), size = 2.5)+
scale_color_manual(legend_title, values = c("mediumseagreen", "gold", "orange1","red2"))+
coord_sf(xlim = c(-93.41, -92.1), ylim= c(44.4, 45.2)) +
annotate(geom="text", x=-93.21, y=44.65, label="Minnesota",
size = 5, color = "tan3")+
annotate(geom="text", x=-92.3, y=44.7, label="Wisconsin",
size = 5, color = "tan3")+
labs(x = "", y = "", title = "Fecal Coliform Bacteria (FCB) Levels in the Mississippi River", subtitle = "Data from 2019 and 2020 at 34 monitoring stations in Southeastern Minnesota", caption = "Plot by Vivian Powell | Data from Metropolitan Council EIMS") +
annotation_scale(location = "bl")+
theme_classic() +
theme(legend.position = c(.95, .95),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.box.background = element_rect(color="black", size=1),
legend.text = element_text(size = 7),legend.title = element_text(size = 8, face = "bold"),
plot.title = element_text(face = "bold", hjust = 0.5), plot.subtitle = element_text(hjust = 0.5),plot.caption = element_text(hjust = 0.5),axis.line=element_blank(),axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
ggplot() +
geom_sf(data = counties, color = "navajowhite", fill = "ivory", size = 0.5) +
geom_sf(data = states_new, color = "tan3", fill = "NA") +
geom_sf(data = mn_cities1, color = "black", size = 3, shape= 15) +
geom_sf(data = rivers %>% filter(NAME_DNR == "Mississippi"),color = "NA", fill = 'cornflowerblue') +
geom_sf(data = wi_rivers %>% filter(WATERBODY_ == "Mississippi River"), color = "NA", fill = "cornflowerblue") +
geom_sf_label_repel(data = mn_cities1, aes(label = Name), nudge_y=0.05) +
geom_sf(data = mississippi_fcb, mapping = aes(color = NA2Cat), size = 2.5)+
scale_color_manual(legend_title, values = c("mediumseagreen", "gold", "orange1","red2"))+
coord_sf(xlim = c(-93.41, -92.1), ylim= c(44.4, 45.2)) +
annotate(geom="text", x=-93.21, y=44.65, label="Minnesota",
size = 5, color = "tan3")+
annotate(geom="text", x=-92.3, y=44.7, label="Wisconsin",
size = 5, color = "tan3")+
labs(x = "", y = "", title = "Fecal Coliform Bacteria (FCB) Levels in the Mississippi River", subtitle = "Data from 2019 and 2020 at 34 monitoring stations in Southeastern Minnesota", caption = "Plot by Vivian Powell | Data from Metropolitan Council EIMS") +
annotation_scale(location = "bl")+
theme_classic() +
theme(legend.position = c(.95, .95),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.box.background = element_rect(color="black", size=1),
legend.text = element_text(size = 7),legend.title = element_text(size = 8, face = "bold"),
plot.title = element_text(face = "bold", hjust = 0.5), plot.subtitle = element_text(hjust = 0.5),plot.caption = element_text(hjust = 0.5),axis.line=element_blank(),axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
